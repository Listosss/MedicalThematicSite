{"ast":null,"code":"import React,{useContext,useEffect,useRef,useState}from'react';import'./Comments.css';import defaultCommentsFile from'./DefaultComments.json';import{AuthContext}from'../../context/AuthContext';import{NavLink}from'react-router-dom';import{ModalWindow}from'../ModalWindow/ModalWindow';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Comment(_ref){let{data}=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:\"comment_wrapper\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"com_avatar\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"avatar\",src:data===null||data===void 0?void 0:data.src})}),/*#__PURE__*/_jsxs(\"div\",{className:\"com_text_wrapper\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"com_username\",children:data===null||data===void 0?void 0:data.username}),/*#__PURE__*/_jsx(\"p\",{className:\"com_text\",children:data===null||data===void 0?void 0:data.text})]})]});}function AddCommentForm(_ref2){let{addComment}=_ref2;const{user}=useContext(AuthContext);const textareaRef=useRef(null);const[myComment,setMyComment]=useState(\"\");const[modalIsOpened,setIsModalOpened]=useState(false);const handleChange=e=>{setMyComment(e.target.value);if(textareaRef.current){textareaRef.current.style.height=\"70px\";textareaRef.current.style.height=`${textareaRef.current.scrollHeight}px`;}};const handleClick=()=>{if(!user){setIsModalOpened(true);return;}if(myComment.trim()){addComment({username:user.name,src:user.avatar,text:myComment});setMyComment(\"\");textareaRef.current.style.height=\"70px\";}};return/*#__PURE__*/_jsxs(_Fragment,{children:[modalIsOpened&&/*#__PURE__*/_jsxs(ModalWindow,{onClose:()=>setIsModalOpened(false),children:[/*#__PURE__*/_jsx(\"p\",{children:\"To interact with article you need an account\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal_links_div\",children:[/*#__PURE__*/_jsx(NavLink,{to:'/login',children:\"Log in\"}),/*#__PURE__*/_jsx(NavLink,{to:'/register',children:\"Sign up\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"add_comment_form\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"add_comment_txt\",children:\"Add your own comment:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"textarea_div\",children:[/*#__PURE__*/_jsx(\"textarea\",{className:\"comment_textarea\",value:myComment,ref:textareaRef,onChange:e=>handleChange(e),maxLength:\"500\",placeholder:\"Write your comment here...\"}),/*#__PURE__*/_jsx(\"div\",{className:\"com_symbols_counter\",children:`${myComment.length}/500`})]}),/*#__PURE__*/_jsx(\"button\",{className:\"comment_btn\",disabled:!myComment.trim(),onClick:handleClick,children:\"Comment\"})]})]});}export default function Comments(_ref3){let{uid}=_ref3;const[comments,setComments]=useState([]);const defaultComments=defaultCommentsFile.defaultComments.sort(()=>Math.random()-0.5).slice(0,5);useEffect(()=>{var _articleData$comments;const savedArticle=localStorage.getItem(`article_${uid}`);const articleData=savedArticle?JSON.parse(savedArticle):null;if(articleData&&articleData!==null&&articleData!==void 0&&(_articleData$comments=articleData.comments)!==null&&_articleData$comments!==void 0&&_articleData$comments.length){setComments(articleData.comments);}else setComments(defaultComments);},[]);useEffect(()=>{if(comments.length>0){localStorage.setItem(`article_${uid}`,JSON.stringify({comments:comments}));}},[comments]);const addComment=_ref4=>{let{username,src,text}=_ref4;const newComment={username,src,text};setComments(comments=>[...comments,newComment]);};return/*#__PURE__*/_jsxs(\"div\",{className:\"comments_wrapper\",children:[/*#__PURE__*/_jsx(AddCommentForm,{addComment:addComment}),/*#__PURE__*/_jsx(\"p\",{className:\"comments_section_txt\",children:\"Comments:\"}),comments.length>0&&comments.map((comment,index)=>/*#__PURE__*/_jsx(Comment,{data:comment},`comment_${index}_${Date.now()}`))]});}","map":{"version":3,"names":["React","useContext","useEffect","useRef","useState","defaultCommentsFile","AuthContext","NavLink","ModalWindow","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Comment","_ref","data","className","children","alt","src","username","text","AddCommentForm","_ref2","addComment","user","textareaRef","myComment","setMyComment","modalIsOpened","setIsModalOpened","handleChange","e","target","value","current","style","height","scrollHeight","handleClick","trim","name","avatar","onClose","to","ref","onChange","maxLength","placeholder","length","disabled","onClick","Comments","_ref3","uid","comments","setComments","defaultComments","sort","Math","random","slice","_articleData$comments","savedArticle","localStorage","getItem","articleData","JSON","parse","setItem","stringify","_ref4","newComment","map","comment","index","Date","now"],"sources":["C:/Users/Админ/Documents/Svarchik/ТПП/kurs/portal/frontend/src/components/Comments/Comments.jsx"],"sourcesContent":["import React, { useContext, useEffect, useRef, useState } from 'react'\r\nimport './Comments.css'\r\nimport defaultCommentsFile from './DefaultComments.json'\r\nimport { AuthContext } from '../../context/AuthContext'\r\nimport { NavLink } from 'react-router-dom'\r\nimport { ModalWindow } from '../ModalWindow/ModalWindow'\r\n\r\nfunction Comment({ data }) {\r\n    return (\r\n        <div className='comment_wrapper'>\r\n            <div className='com_avatar'><img alt='avatar' src={data?.src} /></div>\r\n            <div className='com_text_wrapper'>\r\n                <p className='com_username'>{data?.username}</p>\r\n                <p className='com_text'>{data?.text}</p>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction AddCommentForm({ addComment }) {\r\n    const { user } = useContext(AuthContext)\r\n    const textareaRef = useRef(null);\r\n    const [myComment, setMyComment] = useState(\"\")\r\n    const [modalIsOpened, setIsModalOpened] = useState(false);\r\n\r\n    const handleChange = (e) => {\r\n        setMyComment(e.target.value);\r\n        if (textareaRef.current) {\r\n            textareaRef.current.style.height = \"70px\";\r\n            textareaRef.current.style.height = `${textareaRef.current.scrollHeight}px`\r\n        }\r\n    }\r\n    const handleClick = () => {\r\n        if (!user) {\r\n            setIsModalOpened(true)\r\n            return\r\n        }\r\n        if (myComment.trim()) {\r\n            addComment({ username: user.name, src: user.avatar, text: myComment });\r\n            setMyComment(\"\");\r\n            textareaRef.current.style.height = \"70px\";\r\n        }\r\n\r\n    }\r\n    return (\r\n        <>{modalIsOpened && <ModalWindow onClose={() => setIsModalOpened(false)}>\r\n            <p>To interact with article you need an account</p>\r\n            <div className='modal_links_div'>\r\n                <NavLink to={'/login'} >Log in</NavLink>\r\n                <NavLink to={'/register'} >Sign up</NavLink>\r\n            </div>\r\n        </ModalWindow>}\r\n\r\n            <div className='add_comment_form'>\r\n                <p className='add_comment_txt'>Add your own comment:</p>\r\n                <div className='textarea_div'>\r\n                    <textarea className='comment_textarea' value={myComment} ref={textareaRef}\r\n                        onChange={(e) => handleChange(e)} maxLength=\"500\" placeholder=\"Write your comment here...\" />\r\n                    <div className='com_symbols_counter'>{`${myComment.length}/500`}</div>\r\n                </div>\r\n                <button className='comment_btn' disabled={!myComment.trim()} onClick={handleClick}>Comment</button>\r\n            </div></>\r\n    )\r\n}\r\n\r\nexport default function Comments({ uid }) {\r\n\r\n    const [comments, setComments] = useState([]);\r\n    const defaultComments = defaultCommentsFile.defaultComments.sort(() => Math.random() - 0.5).slice(0, 5);\r\n\r\n    useEffect(() => {\r\n        const savedArticle = localStorage.getItem(`article_${uid}`);\r\n        const articleData = savedArticle ? JSON.parse(savedArticle) : null;\r\n\r\n        if (articleData && articleData?.comments?.length) {\r\n            setComments(articleData.comments)\r\n        }\r\n        else setComments(defaultComments)\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        if (comments.length > 0) {\r\n            localStorage.setItem(`article_${uid}`, JSON.stringify({ comments: comments }))\r\n        }\r\n    }, [comments])\r\n\r\n    const addComment = ({ username, src, text }) => {\r\n        const newComment = { username, src, text };\r\n        setComments(comments => [...comments, newComment])\r\n    }\r\n    return (\r\n        <div className='comments_wrapper'>\r\n            <AddCommentForm addComment={addComment} />\r\n            <p className='comments_section_txt'>Comments:</p>\r\n            {comments.length > 0 && comments.map((comment, index) => <Comment data={comment} key={`comment_${index}_${Date.now()}`} />)}\r\n\r\n        </div>\r\n    )\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}