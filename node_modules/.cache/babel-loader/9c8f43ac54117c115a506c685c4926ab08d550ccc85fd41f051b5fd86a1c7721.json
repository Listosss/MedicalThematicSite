{"ast":null,"code":"import React,{useEffect,useState}from'react';import'./NewsPage.css';import{ArticleCard}from'../../components/ArticleCard/ArticleCard';import{ArticlesPagination}from'../../components/ArticlesPagination/ArticlesPagination';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export function NewsPage(){const[articlesData,setArticlesData]=useState([]);const[isLoading,setLoading]=useState(false);const[category,setCategory]=useState(JSON.parse(localStorage.getItem(\"category\")||\"depression\"));const[sortOption,setSortOption]=useState(JSON.parse(localStorage.getItem(\"sortOption\"))||\"\");const[currentPage,setCurrentPage]=useState(JSON.parse(sessionStorage.getItem(\"news_page\"))||1);const resultsPerPage=5;const getNewsArticles=async function(){let currentCategory=arguments.length>0&&arguments[0]!==undefined?arguments[0]:category;let currentSortOption=arguments.length>1&&arguments[1]!==undefined?arguments[1]:sortOption;try{var _data$esearchresult;console.log(currentCategory);setLoading(true);const baseURL=\"https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi\";const retstart=(currentPage-1)*resultsPerPage;const sortUrl=currentSortOption?`&sort=${currentSortOption}`:'';let response;response=await fetch(`${baseURL}?db=pubmed&term=${currentCategory}[Mesh]+AND+HasAbstract[Filter]&retstart=${retstart}&retmax=${resultsPerPage}&retmode=json${sortUrl}`);const data=await response.json();const idArray=data===null||data===void 0?void 0:(_data$esearchresult=data.esearchresult)===null||_data$esearchresult===void 0?void 0:_data$esearchresult.idlist;if(idArray&&idArray.length>0){var _articlesData$result;response=await fetch(`https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=pubmed&id=${idArray.join(',')}&retmode=json`);const articlesData=await response.json();const uids=articlesData===null||articlesData===void 0?void 0:(_articlesData$result=articlesData.result)===null||_articlesData$result===void 0?void 0:_articlesData$result.uids;if(uids&&uids.length>0){const articles=uids.map(id=>{const{title,uid}=articlesData.result[id];const object={title,uid};return object;});setArticlesData(articles);}}setLoading(false);}catch(error){console.error('Error fetching articles:',error);}};useEffect(()=>{setCurrentPage(1);if(category&&sortOption){localStorage.setItem(\"category\",JSON.stringify(category));localStorage.setItem(\"sortOption\",JSON.stringify(sortOption));console.log(category);getNewsArticles();}},[category,sortOption]);useEffect(()=>{sessionStorage.setItem(\"news_page\",JSON.stringify(currentPage));window.scrollTo(0,0);getNewsArticles();},[currentPage]);return/*#__PURE__*/_jsxs(\"div\",{className:\"page_wrapper news_page_wrapper\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filter_articles_panel\",children:[/*#__PURE__*/_jsxs(\"select\",{value:category,onChange:e=>setCategory(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{disabled:true,value:\"\",hidden:true,children:\"Category\"}),/*#__PURE__*/_jsx(\"option\",{value:\"phobia\",children:\"Phobia\"}),/*#__PURE__*/_jsx(\"option\",{value:\"depression\",children:\"Depression\"}),/*#__PURE__*/_jsx(\"option\",{value:\"PTSD\",children:\"PTSD\"}),/*#__PURE__*/_jsx(\"option\",{value:\"mental health\",children:\"Mental health\"}),/*#__PURE__*/_jsx(\"option\",{value:\"anxiety\",children:\"Anxiety\"}),/*#__PURE__*/_jsx(\"option\",{value:\"schizophrenia\",children:\"Schizophrenia\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:sortOption,onChange:e=>setSortOption(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{disabled:true,value:\"\",hidden:true,children:\"Sort by\"}),/*#__PURE__*/_jsx(\"option\",{value:\"pub date\",children:\"Publication Date\"}),/*#__PURE__*/_jsx(\"option\",{value:\"relevance\",children:\"Relevance\"})]})]}),articlesData.length>0&&!isLoading&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"news_page_articles\",children:[articlesData.map((article,index)=>/*#__PURE__*/_jsx(ArticleCard,{article:article},'article'+index)),/*#__PURE__*/_jsx(ArticlesPagination,{page:currentPage,setCurrentPage:setCurrentPage})]})}),!articlesData.length&&!isLoading&&/*#__PURE__*/_jsx(\"p\",{className:\"nothing_found_text\",children:\"Nothing found\"}),isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading_div\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border text-success\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"})})})]});}","map":{"version":3,"names":["React","useEffect","useState","ArticleCard","ArticlesPagination","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","NewsPage","articlesData","setArticlesData","isLoading","setLoading","category","setCategory","JSON","parse","localStorage","getItem","sortOption","setSortOption","currentPage","setCurrentPage","sessionStorage","resultsPerPage","getNewsArticles","currentCategory","arguments","length","undefined","currentSortOption","_data$esearchresult","console","log","baseURL","retstart","sortUrl","response","fetch","data","json","idArray","esearchresult","idlist","_articlesData$result","join","uids","result","articles","map","id","title","uid","object","error","setItem","stringify","window","scrollTo","className","children","value","onChange","e","target","disabled","hidden","article","index","page","role"],"sources":["C:/Users/Админ/Documents/Svarchik/ТПП/kurs/portal/frontend/src/pages/NewsPage/NewsPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport './NewsPage.css'\r\nimport { ArticleCard } from '../../components/ArticleCard/ArticleCard';\r\nimport { ArticlesPagination } from '../../components/ArticlesPagination/ArticlesPagination';\r\n\r\nexport function NewsPage() {\r\n    const [articlesData, setArticlesData] = useState([])\r\n    const [isLoading, setLoading] = useState(false);\r\n    const [category, setCategory] = useState(JSON.parse(localStorage.getItem(\"category\") || \"depression\"));\r\n    const [sortOption, setSortOption] = useState(JSON.parse(localStorage.getItem(\"sortOption\")) || \"\");\r\n    const [currentPage, setCurrentPage] = useState(JSON.parse(sessionStorage.getItem(\"news_page\")) || 1);\r\n    const resultsPerPage = 5;\r\n\r\n    const getNewsArticles = async (currentCategory = category, currentSortOption = sortOption) => {\r\n        try {\r\n            console.log(currentCategory)\r\n            setLoading(true);\r\n            const baseURL = \"https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi\";\r\n            const retstart = (currentPage - 1) * resultsPerPage;\r\n            const sortUrl = currentSortOption ? `&sort=${currentSortOption}` : '';\r\n\r\n            let response;\r\n            response = await fetch(`${baseURL}?db=pubmed&term=${currentCategory}[Mesh]+AND+HasAbstract[Filter]&retstart=${retstart}&retmax=${resultsPerPage}&retmode=json${sortUrl}`);\r\n            const data = await response.json();\r\n            const idArray = data?.esearchresult?.idlist\r\n\r\n            if (idArray && idArray.length > 0) {\r\n                response = await fetch(`https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=pubmed&id=${idArray.join(',')}&retmode=json`);\r\n                const articlesData = await response.json();\r\n                const uids = articlesData?.result?.uids;\r\n                if (uids && uids.length > 0) {\r\n                    const articles = uids.map(id => {\r\n                        const { title, uid } = articlesData.result[id];\r\n                        const object = { title, uid };\r\n                        return object\r\n                    });\r\n                    setArticlesData(articles);\r\n                }\r\n            }\r\n\r\n            setLoading(false)\r\n        } catch (error) {\r\n            console.error('Error fetching articles:', error);\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        setCurrentPage(1)\r\n        if (category && sortOption) {\r\n            localStorage.setItem(\"category\", JSON.stringify(category))\r\n            localStorage.setItem(\"sortOption\", JSON.stringify(sortOption));\r\n            console.log(category)\r\n            getNewsArticles();\r\n        }\r\n    }, [category, sortOption])\r\n\r\n    useEffect(() => {\r\n        sessionStorage.setItem(\"news_page\", JSON.stringify(currentPage));\r\n        window.scrollTo(0, 0);\r\n        getNewsArticles();\r\n    }, [currentPage])\r\n\r\n    return (\r\n        <div className='page_wrapper news_page_wrapper'>\r\n            <div className='filter_articles_panel'>\r\n                <select value={category} onChange={e => setCategory(e.target.value)}>\r\n                    <option disabled value={\"\"} hidden>Category</option>\r\n                    <option value={\"phobia\"}>Phobia</option>\r\n                    <option value={\"depression\"}>Depression</option>\r\n                    <option value={\"PTSD\"}>PTSD</option>\r\n                    <option value={\"mental health\"}>Mental health</option>\r\n                    <option value={\"anxiety\"}>Anxiety</option>\r\n                    <option value={\"schizophrenia\"}>Schizophrenia</option>\r\n                </select>\r\n\r\n                <select value={sortOption} onChange={e => setSortOption(e.target.value)}>\r\n                    <option disabled value={\"\"} hidden>Sort by</option>\r\n                    <option value=\"pub date\">Publication Date</option>\r\n                    <option value=\"relevance\">Relevance</option>\r\n                </select>\r\n            </div>\r\n\r\n            {(articlesData.length > 0 && !isLoading) && <>\r\n                <div className='news_page_articles'>\r\n                    {articlesData.map((article, index) => <ArticleCard article={article} key={'article' + index} />)}\r\n                    <ArticlesPagination page={currentPage} setCurrentPage={setCurrentPage} />\r\n                </div>\r\n            </>}\r\n            {(!articlesData.length && !isLoading) && <p className='nothing_found_text'>Nothing found</p>}\r\n            {isLoading && <div className='loading_div'><div className=\"spinner-border text-success\" role=\"status\" >\r\n                <span className=\"visually-hidden\">Загрузка...</span></div></div>}\r\n        </div>\r\n    )\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}